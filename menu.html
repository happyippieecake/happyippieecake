<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manajemen Menu - Cake Order</title>
  <script src="js/menu.js" defer></script>
  <!-- Link Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex min-h-screen">
    <!-- Sidebar -->
    <div class="w-64 bg-gray-800 text-white p-6 flex flex-col">
      <h2 class="text-2xl font-bold text-center mb-8">CakeAdmin</h2>
      <ul class="space-y-4">
        <li><a href="admin.html" class="text-gray-400 hover:bg-blue-600 hover:text-white px-4 py-2 rounded block">Dashboard</a></li>
        <li><a href="menu.html" class="text-gray-400 hover:bg-blue-600 hover:text-white px-4 py-2 rounded block bg-blue-600">Menu</a></li>
        <li><a href="orders.html" class="text-gray-400 hover:bg-blue-600 hover:text-white px-4 py-2 rounded block">Pesanan</a></li>
        <li><a href="users.html" class="text-gray-400 hover:bg-blue-600 hover:text-white px-4 py-2 rounded block">Pengguna</a></li>
        <li><a href="#" onclick="logout()" class="text-gray-400 hover:bg-blue-600 hover:text-white px-4 py-2 rounded block">Logout</a></li>
      </ul>
    </div>

    <!-- Main Content -->
    <div class="flex-1 p-8">
      <header class="mb-8">
        <h1 class="text-3xl font-semibold text-gray-800">Manajemen Menu</h1>
        <button class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mt-4" onclick="openAddModal()">Tambah Menu</button>
      </header>

      <table class="min-w-full bg-white shadow-md rounded-lg overflow-hidden">
        <thead>
          <tr class="bg-blue-600 text-white uppercase text-sm">
            <th class="p-4">Nama Kue</th>
            <th class="p-4">Harga</th>
            <th class="p-4">Gambar</th>
            <th class="p-4">Aksi</th>
          </tr>
        </thead>
        <tbody id="menuTable" class="text-sm">
          <!-- Data menu akan diisi melalui JavaScript -->
        </tbody>
      </table>
    </div>
    
    <!-- Modal Tambah/Edit Menu -->
    <div id="menuModal" class="modal hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-60">
      <div class="bg-gradient-to-br from-white to-gray-100 p-8 rounded-lg shadow-xl w-96 transform scale-90 transition-all duration-300">
        <h2 id="modalTitle" class="text-xl font-bold text-gray-700 text-center mb-6">Tambah Menu</h2>
        <form id="menuForm">
          <label for="namaKue" class="block text-gray-600 font-semibold mb-2">Nama Kue</label>
          <input type="text" id="namaKue" required class="w-full p-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 mb-4">

          <label for="hargaKue" class="block text-gray-600 font-semibold mb-2">Harga</label>
          <input type="number" id="hargaKue" required class="w-full p-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 mb-4">

          <label for="gambarKue" class="block text-gray-600 font-semibold mb-2">Gambar Kue</label>
          <input type="file" id="gambarKue" accept="image/*" class="file-input w-full p-3 border-2 border-gray-300 rounded-lg mb-4" required>

          <div class="flex justify-between">
            <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Simpan</button>
            <button type="button" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700" onclick="closeModal()">Batal</button>
          </div>
        </form>
      </div>
    </div>

    <script>
      let menuData = [
        { id: 1, nama: "Half Cake", harga: 175000, gambar: "../static/gambar/cake 1.jpg" },
        { id: 2, nama: "Whole Cake", harga: 250000, gambar: "../static/gambar/cake 2.jpg" }
      ];

      let editId = null;

      function renderTable() {
        const menuTable = document.getElementById("menuTable");
        menuTable.innerHTML = menuData.map(menu => `
          <tr class="border-b hover:bg-gray-100">
            <td class="p-4">${menu.nama}</td>
            <td class="p-4">Rp ${menu.harga.toLocaleString()}</td>
            <td class="p-4">
              ${menu.gambar ? `<img src="${menu.gambar}" alt="${menu.nama}" class="w-12 h-12 object-cover rounded-lg">` : "Tidak ada gambar"}
            </td>
            <td class="p-4">
              <button class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600" onclick="editMenu(${menu.id})">Edit</button>
              <button class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600" onclick="deleteMenu(${menu.id})">Hapus</button>
            </td>
          </tr>
        `).join('');
      }

      function openAddModal() {
        editId = null;
        document.getElementById("modalTitle").innerText = "Tambah Menu";
        document.getElementById("namaKue").value = "";
        document.getElementById("hargaKue").value = "";
        document.getElementById("gambarKue").value = "";
        document.getElementById("menuModal").classList.remove("hidden");
      }

      function editMenu(id) {
        const menu = menuData.find(item => item.id === id);
        editId = id;
        document.getElementById("modalTitle").innerText = "Edit Menu";
        document.getElementById("namaKue").value = menu.nama;
        document.getElementById("hargaKue").value = menu.harga;
        document.getElementById("gambarKue").value = "";
        document.getElementById("menuModal").classList.remove("hidden");
      }

      document.getElementById("menuForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const namaKue = document.getElementById("namaKue").value;
        const hargaKue = parseInt(document.getElementById("hargaKue").value, 10);
        const gambarKue = document.getElementById("gambarKue").files[0];

        let gambarUrl = "";
        if (gambarKue) {
          gambarUrl = URL.createObjectURL(gambarKue);
        }

        if (editId) {
          const menu = menuData.find(item => item.id === editId);
          menu.nama = namaKue;
          menu.harga = hargaKue;
          menu.gambar = gambarUrl;
        } else {
          menuData.push({ id: Date.now(), nama: namaKue, harga: hargaKue, gambar: gambarUrl });
        }

        closeModal();
        renderTable();
      });

      function deleteMenu(id) {
        menuData = menuData.filter(item => item.id !== id);
        renderTable();
      }

      function closeModal() {
        document.getElementById("menuModal").classList.add("hidden");
      }

      document.addEventListener("DOMContentLoaded", renderTable);

      function logout() {
        alert("Anda berhasil logout!");
        window.location.href = "login.html";
      }
    </script>
</body>
</html>
